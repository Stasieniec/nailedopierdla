---
import '../styles/global.css';

// SEO Configuration
const siteTitle = "Na ile do pierdla? - Kalkulator Kar WiÄ™zienia";
const siteDescription = "Interaktywny kalkulator oparty na polskim prawie karnym (KK i KW). SprawdÅº jakie przestÄ™pstwa gwarantujÄ… wybrany okres w wiÄ™zieniu. Bazuje na rzeczywistych przepisach i karach.";
const siteUrl = "https://nailedopierdla.pages.dev"; // Update with your actual domain
const siteImage = `${siteUrl}/og-image.jpg`; // We'll create this
const keywords = "kalkulator przestÄ™pstw, kary wiÄ™zienia, prawo karne, kodeks karny, KK, KW, ile za przestÄ™pstwo, kara pozbawienia wolnoÅ›ci, pierdla, wiÄ™zienie, polskie prawo";
---

<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    
    <!-- Primary Meta Tags -->
    <title>{siteTitle}</title>
    <meta name="title" content={siteTitle}>
    <meta name="description" content={siteDescription}>
    <meta name="keywords" content={keywords}>
    <meta name="author" content="Na ile do pierdla">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Polish">
    <meta name="revisit-after" content="7 days">
    
    <!-- Canonical URL -->
    <link rel="canonical" href={siteUrl}>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content={siteUrl}>
    <meta property="og:title" content={siteTitle}>
    <meta property="og:description" content={siteDescription}>
    <meta property="og:image" content={siteImage}>
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="pl_PL">
    <meta property="og:site_name" content="Na ile do pierdla?">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content={siteUrl}>
    <meta name="twitter:title" content={siteTitle}>
    <meta name="twitter:description" content={siteDescription}>
    <meta name="twitter:image" content={siteImage}>
    
    <!-- Additional SEO -->
    <meta name="theme-color" content="#1e3a8a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Na ile do pierdla?">
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Na ile do pierdla?",
      "description": "Kalkulator przestÄ™pstw oparty na polskim Kodeksie Karnym (KK) i Kodeksie WykroczeÅ„ (KW). Oblicz wymagane przestÄ™pstwa dla wybranego okresu wiÄ™zienia.",
      "url": "https://nailedopierdla.pages.dev",
      "applicationCategory": "EducationalApplication",
      "operatingSystem": "Any",
      "browserRequirements": "Requires JavaScript",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "PLN"
      },
      "inLanguage": "pl-PL",
      "audience": {
        "@type": "Audience",
        "audienceType": "Educational"
      },
      "keywords": "kalkulator przestÄ™pstw, kary wiÄ™zienia, prawo karne, kodeks karny, KK, KW"
    }
    </script>
</head>
<body class="min-h-screen bg-white">
    <div class="min-h-screen flex items-center justify-center p-4 bg-slate-50">
        <div class="max-w-4xl w-full">
            <!-- Header -->
            <header class="text-center mb-8 md:mb-12 animate-fade-in px-2">
                <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-bold text-blue-900 mb-4 leading-tight">
                    Na ile do <span class="text-blue-900">pierdla</span>?
                </h1>
                <p class="text-base sm:text-lg md:text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed">
                    PrzygniatajÄ…cy ciÄ™Å¼ar rzeczywistoÅ›ci sprawia, Å¼e chcesz zniknÄ…Ä‡ na parÄ™ lat? MoÅ¼e by tak pÃ³jÅ›Ä‡ wiÄ™zienia na zimÄ™? Albo przeczekaÄ‡ lato w klimatyzowanej celi? Wpisz wybrany okres czasu i dowiedz siÄ™ jakie przestÄ™pstwa go gwarantujÄ….
                </p>
            </header>

            <!-- Calculator Card -->
            <main class="bg-white rounded-xl p-6 sm:p-8 md:p-12 shadow-lg border border-slate-200">
                <!-- Time Slider Section -->
                <section class="mb-6 md:mb-8" aria-label="WybÃ³r czasu">
                    <label for="time-slider" class="block text-slate-800 text-lg sm:text-xl font-semibold mb-4">
                        Wybierz czas: <span id="time-display" class="text-blue-600" aria-live="polite">1 rok</span>
                    </label>
                    
                    <!-- Manual Input Section -->
                    <div class="mb-4 flex flex-col sm:flex-row gap-3">
                        <div class="flex-1">
                            <label for="time-input" class="block text-slate-700 text-sm font-medium mb-2">Precyzyjny wybÃ³r:</label>
                            <div class="flex gap-2">
                                <input 
                                    type="number" 
                                    id="time-input" 
                                    min="1" 
                                    max="300" 
                                    value="12"
                                    class="flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-slate-800"
                                    aria-label="WprowadÅº liczbÄ™"
                                >
                                <select 
                                    id="time-unit" 
                                    class="px-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 text-slate-800 bg-white"
                                    aria-label="Wybierz jednostkÄ™ czasu"
                                >
                                    <option value="days">dni</option>
                                    <option value="months" selected>miesiÄ™cy</option>
                                    <option value="years">lat</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex items-end">
                            <label class="flex items-center gap-2 px-4 py-2 bg-slate-100 rounded-lg cursor-pointer hover:bg-slate-200 transition-colors">
                                <input 
                                    type="checkbox" 
                                    id="life-sentence" 
                                    class="w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-600"
                                    aria-label="DoÅ¼ywocie"
                                >
                                <span class="text-slate-800 font-medium">DoÅ¼ywocie</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Slider -->
                    <div class="relative">
                        <input 
                            type="range" 
                            id="time-slider" 
                            min="0.033" 
                            max="300" 
                            step="0.033"
                            value="12" 
                            class="w-full h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer slider touch-manipulation"
                            aria-label="Suwak wyboru czasu wiÄ™zienia"
                        >
                        <div class="flex justify-between text-xs sm:text-sm text-slate-500 mt-2">
                            <span>1 dzieÅ„</span>
                            <span>25 lat</span>
                        </div>
                    </div>
                </section>

                <!-- Calculate Button -->
                <button 
                    id="calculate-btn"
                    class="w-full bg-blue-900 text-white text-lg sm:text-xl font-bold py-3 sm:py-4 px-6 sm:px-8 rounded-xl hover:bg-blue-800 transition-colors duration-200 shadow-lg focus:outline-none focus:ring-4 focus:ring-blue-600/50"
                    aria-label="Oblicz kombinacjÄ™ przestÄ™pstw"
                >
                    Oblicz przestÄ™pstwa
                </button>

                <!-- Results Section -->
                <section id="results" class="mt-6 md:mt-8 hidden" aria-label="Wyniki kalkulacji">
                    <div class="border-t border-slate-200 pt-6 md:pt-8">
                        <h2 class="text-xl sm:text-2xl font-bold text-slate-800 mb-4 md:mb-6 leading-tight">
                            Twoja Å›cieÅ¼ka do <span class="text-blue-600" id="result-time"></span>:
                        </h2>
                        <div id="crimes-list" class="space-y-3 md:space-y-4" role="list">
                            <!-- Crimes will be inserted here -->
                        </div>
                    </div>
                </section>
            </main>

            <!-- Disclaimer -->
            <footer class="mt-6 md:mt-8 text-center text-slate-500 text-xs sm:text-sm px-4 leading-relaxed">
                <p>Kary oparte o polski Kodeks Karny (KK) i Kodeks WykroczeÅ„ (KW).</p>
                <p class="mt-1">Informacje majÄ… charakter wyÅ‚Ä…cznie informacyjny i nie stanowiÄ… porady prawnej.</p>
            </footer>
        </div>
    </div>

    <script>
        // Crime database based on actual Polish law
        const offencesPL = [
            // WYKROCZENIA (KW) â€“ minor offenses with arrests in days
            { name: "Niszczenie lub uszkadzanie drzew/krzewÃ³w (wykroczenie)", law: "KW", basis: "art. 162", penalty: "areszt / ograniczenie wolnoÅ›ci / grzywna", minMonths: 0.033, maxMonths: 1, emoji: "ğŸŒ³" },
            { name: "Niszczenie lub uszkadzanie urzÄ…dzeÅ„ uÅ¼ytku publicznego", law: "KW", basis: "art. 124a", penalty: "areszt do 30 dni / ograniczenie wolnoÅ›ci / grzywna", minMonths: 0.033, maxMonths: 1, emoji: "ğŸš" },
            { name: "KradzieÅ¼ do 800 zÅ‚ (wykroczenie)", law: "KW", basis: "art. 119 Â§1", penalty: "areszt / ograniczenie wolnoÅ›ci / grzywna", minMonths: 0.5, maxMonths: 1, emoji: "ğŸ›’" },
            { name: "ZakÅ‚Ã³canie spokoju / porzÄ…dku publicznego", law: "KW", basis: "art. 51", penalty: "areszt / ograniczenie wolnoÅ›ci / grzywna", minMonths: 0.5, maxMonths: 1, emoji: "ğŸ“¢" },
            { name: "Uszkodzenie lub zniszczenie mienia do 800 zÅ‚ (wykroczenie)", law: "KW", basis: "art. 124 Â§1", penalty: "areszt / ograniczenie wolnoÅ›ci / grzywna", minMonths: 0.5, maxMonths: 1, emoji: "ğŸ”¨" },
            { name: "Prowadzenie pojazdu w stanie po uÅ¼yciu alkoholu (wykroczenie)", law: "KW", basis: "art. 87", penalty: "areszt albo grzywna (min. 2500 zÅ‚) + zakaz prowadzenia", minMonths: 0.5, maxMonths: 1, emoji: "ğŸº" },
            { name: "Nielegalne przekraczanie granicy (wykroczenie)", law: "KW", basis: "art. 49", penalty: "areszt / grzywna", minMonths: 0.033, maxMonths: 1, emoji: "ğŸš§" },
            { name: "ZakÅ‚Ã³canie porzÄ…dku w miejscach publicznych", law: "KW", basis: "art. 141", penalty: "areszt / ograniczenie wolnoÅ›ci / grzywna", minMonths: 0.033, maxMonths: 1, emoji: "ğŸ­" },

            // PRZESTÄ˜PSTWA KRÃ“TKOTERMINOWE (do 2 lat)
            { name: "GroÅºba karalna", law: "KK", basis: "art. 190 Â§1", penalty: "pozb. woln. do 3 lat", minMonths: 1, maxMonths: 36, emoji: "â˜ï¸" },
            { name: "Naruszenie miru domowego (wtargniÄ™cie / nieopuszczenie terenu)", law: "KK", basis: "art. 193", penalty: "grzywna / ograniczenie / pozb. woln. do 1 roku", minMonths: 1, maxMonths: 12, emoji: "ğŸ " },
            { name: "ZÅ‚oÅ›liwe przeszkadzanie pogrzebowi / obrzÄ™dom", law: "KK", basis: "art. 195", penalty: "grzywna / ograniczenie / pozb. woln. do 2 lat", minMonths: 1, maxMonths: 24, emoji: "âš°ï¸" },
            { name: "ZniewaÅ¼enie pomnika lub miejsca pamiÄ™ci", law: "KK", basis: "art. 261", penalty: "grzywna / ograniczenie wolnoÅ›ci", minMonths: 0.5, maxMonths: 2, emoji: "ğŸ—¿" },
            { name: "Obraza uczuÄ‡ religijnych", law: "KK", basis: "art. 196", penalty: "grzywna / ograniczenie / pozb. woln. do 2 lat", minMonths: 1, maxMonths: 24, emoji: "â›ª" },
            { name: "Nielegalne udostÄ™pnianie danych osobowych", law: "KK", basis: "art. 267a", penalty: "pozb. woln. do 2 lat", minMonths: 1, maxMonths: 24, emoji: "ğŸ“±" },

            // PRZESTÄ˜PSTWA ÅšREDNIOTERMINOWE (3 mies. â€“ 5 lat)
            { name: "KradzieÅ¼", law: "KK", basis: "art. 278 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸ›’" },
            { name: "ZabÃ³r pojazdu w celu krÃ³tkotrwaÅ‚ego uÅ¼ycia (tzw. joyriding)", law: "KK", basis: "art. 289 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸš—" },
            { name: "Zniszczenie cudzej rzeczy (np. graffiti jako szkoda)", law: "KK", basis: "art. 288 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸ¨" },
            { name: "Paserstwo (handel/ukrywanie rzeczy z przestÄ™pstwa)", law: "KK", basis: "art. 291 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸ“¦" },
            { name: "FaÅ‚szowanie dokumentu", law: "KK", basis: "art. 270 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸ“" },
            { name: "ZnÄ™canie siÄ™", law: "KK", basis: "art. 207 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸ§±" },
            { name: "Pobicie / bÃ³jka (podstawowy typ)", law: "KK", basis: "art. 158 Â§1", penalty: "pozb. woln. do 3 lat", minMonths: 1, maxMonths: 36, emoji: "ğŸ¤œ" },
            { name: "Prowadzenie pojazdu w stanie nietrzeÅºwoÅ›ci (przestÄ™pstwo)", law: "KK", basis: "art. 178a Â§1", penalty: "pozb. woln. do 3 lat", minMonths: 1, maxMonths: 36, emoji: "ğŸº" },
            { name: "Bezprawne pozbawienie wolnoÅ›ci (podstawowy)", law: "KK", basis: "art. 189 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸšª" },

            // PRZESTÄ˜PSTWA ÅšREDNIO-POWAÅ»NE (6 mies. â€“ 8/10 lat)
            { name: "KradzieÅ¼ szczegÃ³lnie zuchwaÅ‚a", law: "KK", basis: "art. 278 Â§3a", penalty: "pozb. woln. 6 mies. â€“ 8 lat", minMonths: 6, maxMonths: 96, emoji: "ğŸ§¤" },
            { name: "Oszustwo", law: "KK", basis: "art. 286 Â§1", penalty: "pozb. woln. 6 mies. â€“ 8 lat", minMonths: 6, maxMonths: 96, emoji: "ğŸ’³" },
            { name: "Uporczywe nÄ™kanie / kradzieÅ¼ toÅ¼samoÅ›ci", law: "KK", basis: "art. 190a Â§1â€“2", penalty: "pozb. woln. 6 mies. â€“ 8 lat", minMonths: 6, maxMonths: 96, emoji: "ğŸ•µï¸" },
            { name: "Nielegalne posiadanie broni palnej lub amunicji", law: "KK", basis: "art. 263 Â§2", penalty: "pozb. woln. 6 mies. â€“ 8 lat", minMonths: 6, maxMonths: 96, emoji: "ğŸ”«" },
            { name: "KradzieÅ¼ z wÅ‚amaniem", law: "KK", basis: "art. 279 Â§1", penalty: "pozb. woln. 1 â€“ 10 lat", minMonths: 12, maxMonths: 120, emoji: "ğŸªŸ" },
            { name: "Uszkodzenie podmorskiego kabla (tak, serio)", law: "KK", basis: "art. 288 Â§3", penalty: "pozb. woln. 1 â€“ 10 lat", minMonths: 12, maxMonths: 120, emoji: "ğŸŒŠ" },
            { name: "Bezprawne pozbawienie wolnoÅ›ci dÅ‚uÅ¼ej niÅ¼ 7 dni", law: "KK", basis: "art. 189 Â§2", penalty: "pozb. woln. 1 â€“ 10 lat", minMonths: 12, maxMonths: 120, emoji: "â›“ï¸" },
            { name: "ZgwaÅ‚cenie", law: "KK", basis: "art. 197 Â§1", penalty: "pozb. woln. 2 â€“ 15 lat", minMonths: 24, maxMonths: 180, emoji: "ğŸš«" },
            { name: "UdziaÅ‚ w zorganizowanej grupie przestÄ™pczej", law: "KK", basis: "art. 258 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat (w zw. z innymi: do 15 lat)", minMonths: 3, maxMonths: 180, emoji: "ğŸ‘¥" },

            // PRZESTÄ˜PSTWA POWAÅ»NE (2-15 lat)
            { name: "Spowodowanie ciÄ™Å¼kiego uszczerbku na zdrowiu", law: "KK", basis: "art. 156 Â§1", penalty: "pozb. woln. 1 â€“ 10 lat", minMonths: 12, maxMonths: 120, emoji: "ğŸ¥" },
            { name: "RozbÃ³j (napad z uÅ¼yciem przemocy)", law: "KK", basis: "art. 280 Â§1", penalty: "pozb. woln. 2 â€“ 15 lat", minMonths: 24, maxMonths: 180, emoji: "ğŸ’°" },
            { name: "Wymuszenie rozbÃ³jnicze", law: "KK", basis: "art. 282", penalty: "pozb. woln. 1 â€“ 10 lat", minMonths: 12, maxMonths: 120, emoji: "ğŸ”ª" },
            { name: "Porwanie dla okupu", law: "KK", basis: "art. 252 Â§2", penalty: "pozb. woln. 3 â€“ 20 lat", minMonths: 36, maxMonths: 240, emoji: "ğŸ’µ" },
            { name: "Produkcja lub handel znacznymi iloÅ›ciami narkotykÃ³w", law: "KK", basis: "art. 63 ustawy o przeciwdziaÅ‚aniu narkomanii", penalty: "pozb. woln. 2 â€“ 15 lat", minMonths: 24, maxMonths: 180, emoji: "ğŸ’Š" },

            // PRZESTÄ˜PSTWA BARDZO POWAÅ»NE (3-25 lat)
            { name: "ZabÃ³jstwo", law: "KK", basis: "art. 148 Â§1", penalty: "pozb. woln. 8 â€“ 15 lat / 25 lat / doÅ¼ywocie", minMonths: 96, maxMonths: 300, emoji: "â˜ ï¸" },
            { name: "ZabÃ³jstwo ze szczegÃ³lnym okrucieÅ„stwem", law: "KK", basis: "art. 148 Â§2", penalty: "pozb. woln. 12 â€“ 25 lat / doÅ¼ywocie", minMonths: 144, maxMonths: 300, emoji: "ğŸ”´" },
            { name: "Handel ludÅºmi", law: "KK", basis: "art. 189a Â§1", penalty: "pozb. woln. 3 â€“ 20 lat", minMonths: 36, maxMonths: 240, emoji: "â›“ï¸" },
            { name: "WziÄ™cie zakÅ‚adnika", law: "KK", basis: "art. 252 Â§1", penalty: "pozb. woln. 3 â€“ 20 lat", minMonths: 36, maxMonths: 240, emoji: "ğŸš¨" },
            { name: "Spowodowanie katastrofy w ruchu lÄ…dowym ze skutkiem Å›miertelnym", law: "KK", basis: "art. 173 Â§4", penalty: "pozb. woln. 2 â€“ 15 lat", minMonths: 24, maxMonths: 180, emoji: "ğŸš‚" },
            { name: "Terroryzm", law: "KK", basis: "art. 115 Â§20 + 148", penalty: "pozb. woln. do 25 lat / doÅ¼ywocie", minMonths: 60, maxMonths: 300, emoji: "ğŸ’£" },
            { name: "Zdrada kraju", law: "KK", basis: "art. 127", penalty: "pozb. woln. 5 â€“ 25 lat / doÅ¼ywocie", minMonths: 60, maxMonths: 300, emoji: "ğŸ•µï¸â€â™‚ï¸" },
        ];

        function formatTime(months: number): string {
            if (months < 1) {
                const days = Math.round(months * 30);
                return days === 1 ? "1 dzieÅ„" : `${days} dni`;
            } else if (months < 12) {
                const rounded = Math.round(months);
                return rounded === 1 ? "1 miesiÄ…c" : `${rounded} miesiÄ™cy`;
            } else {
                const years = Math.floor(months / 12);
                const remainingMonths = Math.round(months % 12);
                if (remainingMonths === 0) {
                    return years === 1 ? "1 rok" : `${years} lat`;
                } else {
                    return `${years} ${years === 1 ? 'rok' : 'lat'} i ${remainingMonths} ${remainingMonths === 1 ? 'miesiÄ…c' : 'miesiÄ™cy'}`;
                }
            }
        }

        function getSeverityTip(targetMonths: number, minMonths: number, maxMonths: number): string {
            const range = maxMonths - minMonths;
            const position = (targetMonths - minMonths) / range;
            
            if (position < 0.25) {
                return "ğŸ’¡ <strong>Niski wymiar kary:</strong> Czyn powinien byÄ‡ mniej powaÅ¼ny, sprawca skruszony, brak recydywy, okolicznoÅ›ci Å‚agodzÄ…ce (art. 53 KK).";
            } else if (position < 0.45) {
                return "ğŸ’¡ <strong>PoniÅ¼ej Å›redniej:</strong> Ograniczona szkodliwoÅ›Ä‡ spoÅ‚eczna, brak zÅ‚ego zamiaru, wspÃ³Å‚praca z organami.";
            } else if (position < 0.55) {
                return "ğŸ’¡ <strong>Åšredni wymiar:</strong> Standardowe okolicznoÅ›ci, typowy przebieg przestÄ™pstwa.";
            } else if (position < 0.75) {
                return "ğŸ’¡ <strong>PowyÅ¼ej Å›redniej:</strong> ZwiÄ™kszona szkodliwoÅ›Ä‡, zaplanowane dziaÅ‚anie, wiÄ™ksza skala czynu.";
            } else {
                return "ğŸ’¡ <strong>Wysoki wymiar kary:</strong> Czyn szczegÃ³lnie raÅ¼Ä…cy, powaÅ¼ne skutki, recydywa, dziaÅ‚anie w zorganizowanej grupie, brak skruchy.";
            }
        }

        function calculateCrimes(targetMonths: number) {
            const result: Array<{
                crime: typeof offencesPL[0], 
                count: number, 
                targetPerCrime: number,
                severityTip: string
            }> = [];
            let remainingMonths = targetMonths;
            
            // Shuffle crimes for variety and randomness
            const shuffledCrimes = [...offencesPL].sort(() => Math.random() - 0.5);
            
            // Track what severity levels we've used (to encourage variety)
            const usedSeverityLevels = new Set<string>(); // 'low', 'medium', 'high'
            
            // Helper function to score how "round" a number is
            function getRoundnessScore(months: number): number {
                // Perfect whole years get highest score
                if (months % 12 === 0) return 3.0;
                
                // Half years (6, 18, 30, etc.)
                if (months % 6 === 0) return 2.5;
                
                // Quarter years (3, 9, 15, 21, etc.)
                if (months % 3 === 0) return 2.0;
                
                // Nice single-digit months (1-6)
                if (months >= 1 && months <= 6) return 1.5;
                
                // Other values get lower scores
                return 1.0;
            }
            
            // Score each crime based on how well it fits the remaining target
            function scoreCrime(crime: typeof offencesPL[0], remaining: number) {
                const avgSentence = (crime.minMonths + crime.maxMonths) / 2;
                const range = crime.maxMonths - crime.minMonths;
                
                // Try different count options (prefer lower counts)
                let bestCountScore = -1;
                let bestCount = 1;
                let bestTargetPerCrime = 0;
                
                // Test counts from 1 to 2 (strongly prefer single instances)
                for (let testCount = 1; testCount <= Math.min(2, Math.ceil(remaining / crime.minMonths)); testCount++) {
                    const targetPerCrime = remaining / testCount;
                    
                    // Check if target is within range
                    if (targetPerCrime < crime.minMonths || targetPerCrime > crime.maxMonths) {
                        continue;
                    }
                    
                    // Calculate position in range (0 = min, 1 = max)
                    const position = range > 0 ? (targetPerCrime - crime.minMonths) / range : 0.5;
                    
                    // HUGE bonus for round numbers!
                    const roundnessBonus = getRoundnessScore(targetPerCrime);
                    
                    // Strong preference for single instance
                    const countBonus = testCount === 1 ? 2.5 : 1.2;
                    
                    // Bonus for using different severity levels
                    let severityLevel = 'medium';
                    if (position < 0.35) severityLevel = 'low';
                    else if (position > 0.65) severityLevel = 'high';
                    const severityVarietyBonus = usedSeverityLevels.has(severityLevel) ? 1.0 : 1.4;
                    
                    // Prefer positions that aren't exactly at average (more interesting)
                    const interestBonus = 1 + Math.abs(position - 0.5) * 0.3;
                    
                    const countScore = roundnessBonus * countBonus * severityVarietyBonus * interestBonus;
                    
                    if (countScore > bestCountScore) {
                        bestCountScore = countScore;
                        bestCount = testCount;
                        bestTargetPerCrime = targetPerCrime;
                    }
                }
                
                if (bestCountScore <= 0) {
                    return { score: -1, count: 0, targetPerCrime: 0 };
                }
                
                // Additional scoring factors
                const position = range > 0 ? (bestTargetPerCrime - crime.minMonths) / range : 0.5;
                
                // Penalty for very high ranges (too flexible/boring)
                const rangePenalty = range > 100 ? 0.7 : 1;
                
                // Small random factor for variety
                const randomBonus = Math.random() * 0.3;
                
                const finalScore = bestCountScore * rangePenalty + randomBonus;
                
                return { 
                    score: finalScore, 
                    count: bestCount, 
                    targetPerCrime: bestTargetPerCrime 
                };
            }
            
            // First, break down target into nice round numbers
            function breakdownIntoRoundNumbers(total: number): number[] {
                const pieces: number[] = [];
                let remaining = total;
                
                // Strategy: prefer creating 2-4 pieces with round numbers
                // For large totals, break into nice chunks
                
                if (remaining >= 48) {
                    // For 4+ years, try to split into multiple pieces
                    const yearOptions = [48, 36, 24, 12]; // 4, 3, 2, 1 years
                    for (const yearMonths of yearOptions) {
                        if (remaining >= yearMonths && pieces.length < 3) {
                            pieces.push(yearMonths);
                            remaining -= yearMonths;
                            break; // Only take one, then move to next range
                        }
                    }
                }
                
                // Medium chunks (1-3 years)
                if (remaining >= 24 && pieces.length < 3) {
                    pieces.push(24);
                    remaining -= 24;
                } else if (remaining >= 12 && pieces.length < 3) {
                    pieces.push(12);
                    remaining -= 12;
                }
                
                // Smaller chunks (half years)
                while (remaining >= 6 && pieces.length < 4) {
                    pieces.push(6);
                    remaining -= 6;
                }
                
                // Small chunks (1-5 months)
                if (remaining >= 3 && pieces.length < 5) {
                    pieces.push(3);
                    remaining -= 3;
                }
                
                // Add remaining months as-is
                if (remaining >= 1) {
                    pieces.push(Math.round(remaining));
                }
                
                return pieces;
            }
            
            // Break target into round numbers
            const targetPieces = breakdownIntoRoundNumbers(remainingMonths);
            
            const usedCrimes = new Set<string>();
            
            // Build combination by matching crimes to our target pieces
            for (let pieceIndex = 0; pieceIndex < targetPieces.length; pieceIndex++) {
                const targetPiece = targetPieces[pieceIndex];
                
                // Find best fitting crime for THIS specific piece
                let bestCrime = null;
                let bestScore = -1;
                let bestCount = 0;
                let bestTargetPerCrime = 0;
                
                for (const crime of shuffledCrimes) {
                    if (usedCrimes.has(crime.name)) continue;
                    
                    const result = scoreCrime(crime, targetPiece);
                    if (result.score > bestScore) {
                        bestScore = result.score;
                        bestCrime = crime;
                        bestCount = result.count;
                        bestTargetPerCrime = result.targetPerCrime;
                    }
                }
                
                // If we found a good crime, use it and move to next piece
                if (bestCrime && bestScore > 0) {
                    const actualTarget = Math.min(bestTargetPerCrime, bestCrime.maxMonths);
                    
                    // Track severity level for variety
                    const range = bestCrime.maxMonths - bestCrime.minMonths;
                    const position = range > 0 ? (actualTarget - bestCrime.minMonths) / range : 0.5;
                    let severityLevel = 'medium';
                    if (position < 0.35) severityLevel = 'low';
                    else if (position > 0.65) severityLevel = 'high';
                    usedSeverityLevels.add(severityLevel);
                    
                    const severityTip = getSeverityTip(actualTarget, bestCrime.minMonths, bestCrime.maxMonths);
                    result.push({
                        crime: bestCrime,
                        count: bestCount,
                        targetPerCrime: actualTarget,
                        severityTip
                    });
                    
                    usedCrimes.add(bestCrime.name);
                    // Continue to next piece (don't break the outer loop)
                }
            }
            
            // If we still have nothing, fall back to simplest approach
            if (result.length === 0 && targetMonths > 0) {
                const crime = offencesPL.find(c => 
                    targetMonths >= c.minMonths && targetMonths <= c.maxMonths
                ) || offencesPL[0];
                
                const severityTip = getSeverityTip(targetMonths, crime.minMonths, crime.maxMonths);
                result.push({
                    crime,
                    count: 1,
                    targetPerCrime: Math.min(Math.max(targetMonths, crime.minMonths), crime.maxMonths),
                    severityTip
                });
            }
            
            return result;
        }

        // Elements
        const slider = document.getElementById('time-slider') as HTMLInputElement;
        const timeDisplay = document.getElementById('time-display') as HTMLElement;
        const timeInput = document.getElementById('time-input') as HTMLInputElement;
        const timeUnit = document.getElementById('time-unit') as HTMLSelectElement;
        const lifeSentence = document.getElementById('life-sentence') as HTMLInputElement;
        const calculateBtn = document.getElementById('calculate-btn') as HTMLButtonElement;
        const resultsDiv = document.getElementById('results') as HTMLElement;
        const resultTime = document.getElementById('result-time') as HTMLElement;
        const crimesList = document.getElementById('crimes-list') as HTMLElement;

        let currentMonths = 12;
        let isLifeSentence = false;

        function convertToMonths(value: number, unit: string): number {
            switch(unit) {
                case 'days': return value / 30;
                case 'months': return value;
                case 'years': return value * 12;
                default: return value;
            }
        }

        function updateAllInputs(months: number, fromSource: 'slider' | 'manual' | 'life') {
            currentMonths = months;
            
            // Update display
            if (isLifeSentence) {
                timeDisplay.textContent = "DoÅ¼ywocie";
            } else {
                timeDisplay.textContent = formatTime(months);
            }
            
            // Update slider (if not from slider)
            if (fromSource !== 'slider') {
                slider.value = Math.min(300, Math.max(0.033, months)).toString();
            }
            
            // Update manual input (if not from manual)
            if (fromSource !== 'manual') {
                const unit = timeUnit.value;
                let displayValue: number;
                switch(unit) {
                    case 'days':
                        displayValue = Math.round(months * 30);
                        break;
                    case 'months':
                        displayValue = Math.round(months);
                        break;
                    case 'years':
                        displayValue = Math.round(months / 12 * 100) / 100;
                        break;
                    default:
                        displayValue = months;
                }
                timeInput.value = displayValue.toString();
            }
        }

        // Update display when slider moves
        slider.addEventListener('input', () => {
            if (!isLifeSentence) {
                const months = parseFloat(slider.value);
                updateAllInputs(months, 'slider');
            }
        });

        // Update when manual input changes
        timeInput.addEventListener('input', () => {
            if (!isLifeSentence) {
                const value = parseFloat(timeInput.value) || 1;
                const months = convertToMonths(value, timeUnit.value);
                updateAllInputs(months, 'manual');
            }
        });

        timeUnit.addEventListener('change', () => {
            if (!isLifeSentence) {
                const value = parseFloat(timeInput.value) || 1;
                const months = convertToMonths(value, timeUnit.value);
                updateAllInputs(months, 'manual');
            }
        });

        // Handle life sentence checkbox
        lifeSentence.addEventListener('change', () => {
            isLifeSentence = lifeSentence.checked;
            if (isLifeSentence) {
                timeDisplay.textContent = "DoÅ¼ywocie";
                slider.disabled = true;
                timeInput.disabled = true;
                timeUnit.disabled = true;
            } else {
                slider.disabled = false;
                timeInput.disabled = false;
                timeUnit.disabled = false;
                updateAllInputs(currentMonths, 'manual');
            }
        });

        // Calculate on button click
        calculateBtn.addEventListener('click', () => {
            // Handle life sentence separately
            if (isLifeSentence) {
                resultTime.textContent = "DoÅ¼ywocie";
                crimesList.innerHTML = '';
                
                const lifeCrimes = [
                    { name: "ZabÃ³jstwo", basis: "art. 148 Â§1-2 KK", emoji: "âš°ï¸", description: "ZabÃ³jstwo ze szczegÃ³lnym okrucieÅ„stwem lub w celu osiÄ…gniÄ™cia korzyÅ›ci majÄ…tkowej" },
                    { name: "LudobÃ³jstwo", basis: "art. 118 Â§1 KK", emoji: "ğŸ’€", description: "UdziaÅ‚ w eksterminacji grupy narodowej, etnicznej, rasowej lub religijnej" },
                    { name: "Zbrodnia przeciwko ludzkoÅ›ci", basis: "art. 118a KK", emoji: "ğŸŒ", description: "Systematyczne przeÅ›ladowanie grup ludnoÅ›ci" }
                ];
                
                lifeCrimes.forEach((crime, index) => {
                    const crimeDiv = document.createElement('div');
                    crimeDiv.className = 'bg-red-50 rounded-xl p-4 sm:p-6 border-2 border-red-300 transition-colors hover:bg-red-100 animate-slide-in';
                    crimeDiv.style.animationDelay = `${index * 0.1}s`;
                    crimeDiv.innerHTML = `
                        <div class="flex items-start gap-3 sm:gap-4">
                            <span class="text-3xl sm:text-4xl flex-shrink-0 mt-1 sm:mt-0">${crime.emoji}</span>
                            <div class="flex-1">
                                <h3 class="text-slate-800 font-semibold text-base sm:text-lg">${crime.name}</h3>
                                <p class="text-slate-600 text-xs sm:text-sm mt-1">${crime.description}</p>
                                <p class="text-red-700 text-xs mt-1 font-medium">${crime.basis} | Kara: doÅ¼ywocie</p>
                            </div>
                        </div>
                    `;
                    crimesList.appendChild(crimeDiv);
                });
                
                resultsDiv.classList.remove('hidden');
                resultsDiv.classList.add('animate-fade-in');
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                return;
            }
            
            // Regular calculation
            const months = currentMonths;
            const crimeCombination = calculateCrimes(months);
            
            // Update result time
            resultTime.textContent = formatTime(months);
            
            // Clear previous results
            crimesList.innerHTML = '';
            
            // Add new results with animation and severity tips
            crimeCombination.forEach((item, index) => {
                const crimeDiv = document.createElement('div');
                crimeDiv.className = 'bg-slate-50 rounded-xl p-4 sm:p-6 border border-slate-200 transition-colors hover:bg-slate-100 animate-slide-in';
                crimeDiv.style.animationDelay = `${index * 0.1}s`;
                crimeDiv.setAttribute('role', 'listitem');
                
                const sentenceRange = `${formatTime(item.crime.minMonths)} â€“ ${formatTime(item.crime.maxMonths)}`;
                const targetSentence = formatTime(item.targetPerCrime);
                
                crimeDiv.innerHTML = `
                    <div class="flex flex-col gap-3">
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4">
                            <div class="flex items-start sm:items-center gap-3 sm:gap-4 flex-1">
                                <span class="text-3xl sm:text-4xl flex-shrink-0 mt-1 sm:mt-0" role="img" aria-label="${item.crime.name}">${item.crime.emoji}</span>
                                <div class="flex-1 min-w-0">
                                    <h3 class="text-slate-800 font-semibold text-base sm:text-lg leading-tight">${item.crime.name}</h3>
                                    <p class="text-slate-600 text-xs sm:text-sm mt-1 break-words">
                                        ${item.count}Ã— po ~${targetSentence} | Zakres kary: ${sentenceRange}
                                    </p>
                                    <p class="text-slate-500 text-xs mt-0.5">
                                        ${item.crime.law} ${item.crime.basis}
                                    </p>
                                </div>
                            </div>
                            <div class="text-left sm:text-right flex-shrink-0 pl-10 sm:pl-0">
                                <div class="text-blue-600 font-bold text-lg sm:text-xl">${formatTime(item.targetPerCrime * item.count)}</div>
                                <div class="text-slate-600 text-xs sm:text-sm">razem</div>
                            </div>
                        </div>
                        <div class="bg-blue-50 rounded-lg p-3 text-xs sm:text-sm text-slate-700 border border-blue-200">
                            ${item.severityTip}
                        </div>
                    </div>
                `;
                
                crimesList.appendChild(crimeDiv);
            });
            
            // Show results with animation
            resultsDiv.classList.remove('hidden');
            resultsDiv.classList.add('animate-fade-in');
            
            // Scroll to results smoothly
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        });

        // Initialize display
        updateAllInputs(12, 'manual');
    </script>

    <style>
        @keyframes fade-in {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slide-in {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fade-in 0.6s ease-out;
        }

        .animate-slide-in {
            animation: slide-in 0.4s ease-out backwards;
        }

        /* Custom slider styling */
        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 24px;
            height: 24px;
            background: #1e3a8a;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(30, 58, 138, 0.4);
            transition: all 0.2s;
        }

        .slider::-webkit-slider-thumb:hover {
            background: #1e40af;
            box-shadow: 0 3px 8px rgba(30, 58, 138, 0.5);
        }

        .slider::-webkit-slider-thumb:active {
            background: #1e3a8a;
            box-shadow: 0 2px 6px rgba(30, 58, 138, 0.6);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #1e3a8a;
            cursor: pointer;
            border-radius: 50%;
            border: none;
            box-shadow: 0 2px 6px rgba(30, 58, 138, 0.4);
            transition: all 0.2s;
        }

        .slider::-moz-range-thumb:hover {
            background: #1e40af;
            box-shadow: 0 3px 8px rgba(30, 58, 138, 0.5);
        }

        .slider::-moz-range-thumb:active {
            background: #1e3a8a;
            box-shadow: 0 2px 6px rgba(30, 58, 138, 0.6);
        }

        /* Touch-friendly interactions */
        @media (hover: none) and (pointer: coarse) {
            .slider::-webkit-slider-thumb {
                width: 28px;
                height: 28px;
            }
            .slider::-moz-range-thumb {
                width: 28px;
                height: 28px;
            }
        }

        /* Mobile optimizations */
        @media (max-width: 640px) {
            body {
                -webkit-tap-highlight-color: rgba(30, 58, 138, 0.2);
            }
            
            /* Prevent text overflow */
            h1, h2, h3 {
                word-wrap: break-word;
                overflow-wrap: break-word;
                hyphens: auto;
            }

            /* Better touch targets */
            button {
                min-height: 44px;
            }

            /* Smooth scrolling on mobile */
            html {
                scroll-behavior: smooth;
            }
        }

        /* Prevent landscape issues on mobile */
        @media (max-width: 640px) and (orientation: landscape) {
            .min-h-screen {
                min-height: auto;
            }
        }

        /* Safe area for notched devices */
        @supports (padding: env(safe-area-inset-left)) {
            body {
                padding-left: env(safe-area-inset-left);
                padding-right: env(safe-area-inset-right);
            }
        }
    </style>
</body>
</html>
