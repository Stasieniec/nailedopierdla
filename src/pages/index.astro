---
import '../styles/global.css';

// SEO Configuration
const siteTitle = "Na ile do pierdla? - Kalkulator Kar WiÄ™zienia";
const siteDescription = "Interaktywny kalkulator oparty na polskim prawie karnym (KK i KW). SprawdÅº jakie przestÄ™pstwa gwarantujÄ… wybrany okres w wiÄ™zieniu. Bazuje na rzeczywistych przepisach i karach.";
const siteUrl = "https://nailedopierdla.pages.dev"; // Update with your actual domain
const siteImage = `${siteUrl}/og-image.jpg`; // We'll create this
const keywords = "kalkulator przestÄ™pstw, kary wiÄ™zienia, prawo karne, kodeks karny, KK, KW, ile za przestÄ™pstwo, kara pozbawienia wolnoÅ›ci, pierdla, wiÄ™zienie, polskie prawo";
---

<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>{siteTitle}</title>
    <meta name="title" content={siteTitle}>
    <meta name="description" content={siteDescription}>
    <meta name="keywords" content={keywords}>
    <meta name="author" content="Na ile do pierdla">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Polish">
    <meta name="revisit-after" content="7 days">
    
    <!-- Canonical URL -->
    <link rel="canonical" href={siteUrl}>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content={siteUrl}>
    <meta property="og:title" content={siteTitle}>
    <meta property="og:description" content={siteDescription}>
    <meta property="og:image" content={siteImage}>
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="pl_PL">
    <meta property="og:site_name" content="Na ile do pierdla?">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content={siteUrl}>
    <meta name="twitter:title" content={siteTitle}>
    <meta name="twitter:description" content={siteDescription}>
    <meta name="twitter:image" content={siteImage}>
    
    <!-- Additional SEO -->
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Na ile do pierdla?">
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Na ile do pierdla?",
      "description": "Kalkulator przestÄ™pstw oparty na polskim Kodeksie Karnym (KK) i Kodeksie WykroczeÅ„ (KW). Oblicz wymagane przestÄ™pstwa dla wybranego okresu wiÄ™zienia.",
      "url": "https://nailedopierdla.pages.dev",
      "applicationCategory": "EducationalApplication",
      "operatingSystem": "Any",
      "browserRequirements": "Requires JavaScript",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "PLN"
      },
      "inLanguage": "pl-PL",
      "audience": {
        "@type": "Audience",
        "audienceType": "Educational"
      },
      "keywords": "kalkulator przestÄ™pstw, kary wiÄ™zienia, prawo karne, kodeks karny, KK, KW"
    }
    </script>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900">
    <div class="min-h-screen flex items-center justify-center p-4">
        <div class="max-w-4xl w-full">
            <!-- Header -->
            <header class="text-center mb-12 animate-fade-in">
                <h1 class="text-5xl md:text-7xl font-bold text-white mb-4 drop-shadow-2xl">
                    Na ile do <span class="text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-600">pierdla</span>?
                </h1>
                <p class="text-xl text-gray-300 max-w-2xl mx-auto">
                    PrzygniatajÄ…cy ciÄ™Å¼ar rzeczywistoÅ›ci sprawia, Å¼e chcesz zniknÄ…Ä‡ na parÄ™ lat? Do wiÄ™zienia na zimÄ™? Albo przeczekaÄ‡ lato w klimatyzowanej celi? Wpisz wybrany okres czasu i dowiedz siÄ™ jakie przestÄ™pstwa go gwarantujÄ….
                </p>
            </header>

            <!-- Calculator Card -->
            <main class="bg-white/10 backdrop-blur-lg rounded-3xl p-8 md:p-12 shadow-2xl border border-white/20">
                <!-- Time Slider Section -->
                <section class="mb-8" aria-label="WybÃ³r czasu">
                    <label for="time-slider" class="block text-white text-xl font-semibold mb-4">
                        Wybierz czas: <span id="time-display" class="text-orange-400" aria-live="polite">1 rok</span>
                    </label>
                    <div class="relative">
                        <input 
                            type="range" 
                            id="time-slider" 
                            min="1" 
                            max="120" 
                            value="12" 
                            class="w-full h-3 bg-white/20 rounded-lg appearance-none cursor-pointer slider"
                            aria-label="Suwak wyboru czasu wiÄ™zienia"
                        >
                        <div class="flex justify-between text-sm text-gray-400 mt-2">
                            <span>1 miesiÄ…c</span>
                            <span>10 lat</span>
                        </div>
                    </div>
                </section>

                <!-- Calculate Button -->
                <button 
                    id="calculate-btn"
                    class="w-full bg-gradient-to-r from-orange-500 to-red-600 text-white text-xl font-bold py-4 px-8 rounded-xl hover:from-orange-600 hover:to-red-700 transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-orange-500/50"
                    aria-label="Oblicz kombinacjÄ™ przestÄ™pstw"
                >
                    Oblicz przestÄ™pstwa
                </button>

                <!-- Results Section -->
                <section id="results" class="mt-8 hidden" aria-label="Wyniki kalkulacji">
                    <div class="border-t border-white/20 pt-8">
                        <h2 class="text-2xl font-bold text-white mb-6">
                            Twoja Å›cieÅ¼ka do <span class="text-orange-400" id="result-time"></span>:
                        </h2>
                        <div id="crimes-list" class="space-y-4" role="list">
                            <!-- Crimes will be inserted here -->
                        </div>
                    </div>
                </section>
            </main>

            <!-- Disclaimer -->
            <footer class="mt-8 text-center text-gray-400 text-sm">
                <p>Kary oparte o polski Kodeks Karny (KK) i Kodeks WykroczeÅ„ (KW).</p>
                <p class="mt-1">Informacje majÄ… charakter wyÅ‚Ä…cznie informacyjny i nie stanowiÄ… porady prawnej.</p>
            </footer>
        </div>
    </div>

    <script>
        // Crime database based on actual Polish law
        const offencesPL = [
            // WYKROCZENIA (KW) â€“ minor offenses with arrests in days
            { name: "KradzieÅ¼ do 800 zÅ‚ (wykroczenie)", law: "KW", basis: "art. 119 Â§1", penalty: "areszt / ograniczenie wolnoÅ›ci / grzywna", minMonths: 0.5, maxMonths: 1, emoji: "ğŸ›’" },
            { name: "ZakÅ‚Ã³canie spokoju / porzÄ…dku publicznego", law: "KW", basis: "art. 51", penalty: "areszt / ograniczenie wolnoÅ›ci / grzywna", minMonths: 0.5, maxMonths: 1, emoji: "ğŸ“¢" },
            { name: "Uszkodzenie lub zniszczenie mienia do 800 zÅ‚ (wykroczenie)", law: "KW", basis: "art. 124 Â§1", penalty: "areszt / ograniczenie wolnoÅ›ci / grzywna", minMonths: 0.5, maxMonths: 1, emoji: "ğŸ”¨" },
            { name: "Prowadzenie pojazdu w stanie po uÅ¼yciu alkoholu (wykroczenie)", law: "KW", basis: "art. 87", penalty: "areszt albo grzywna (min. 2500 zÅ‚) + zakaz prowadzenia", minMonths: 0.5, maxMonths: 1, emoji: "ğŸº" },

            // PRZESTÄ˜PSTWA (KK) â€“ crimes with prison time
            { name: "KradzieÅ¼", law: "KK", basis: "art. 278 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸ›’" },
            { name: "KradzieÅ¼ szczegÃ³lnie zuchwaÅ‚a", law: "KK", basis: "art. 278 Â§3a", penalty: "pozb. woln. 6 mies. â€“ 8 lat", minMonths: 6, maxMonths: 96, emoji: "ğŸ§¤" },
            { name: "KradzieÅ¼ z wÅ‚amaniem", law: "KK", basis: "art. 279 Â§1", penalty: "pozb. woln. 1 â€“ 10 lat", minMonths: 12, maxMonths: 120, emoji: "ğŸªŸ" },
            { name: "ZabÃ³r pojazdu w celu krÃ³tkotrwaÅ‚ego uÅ¼ycia (tzw. joyriding)", law: "KK", basis: "art. 289 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸš—" },

            { name: "Zniszczenie cudzej rzeczy (np. graffiti jako szkoda)", law: "KK", basis: "art. 288 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸ¨" },
            { name: "Uszkodzenie podmorskiego kabla (tak, serio)", law: "KK", basis: "art. 288 Â§3", penalty: "pozb. woln. 1 â€“ 10 lat", minMonths: 12, maxMonths: 120, emoji: "ğŸŒŠ" },

            { name: "Paserstwo (handel/ukrywanie rzeczy z przestÄ™pstwa)", law: "KK", basis: "art. 291 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸ“¦" },
            { name: "Oszustwo", law: "KK", basis: "art. 286 Â§1", penalty: "pozb. woln. 6 mies. â€“ 8 lat", minMonths: 6, maxMonths: 96, emoji: "ğŸ’³" },
            { name: "FaÅ‚szowanie dokumentu", law: "KK", basis: "art. 270 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸ“" },

            { name: "GroÅºba karalna", law: "KK", basis: "art. 190 Â§1", penalty: "pozb. woln. do 3 lat", minMonths: 1, maxMonths: 36, emoji: "â˜ï¸" },
            { name: "Uporczywe nÄ™kanie / kradzieÅ¼ toÅ¼samoÅ›ci", law: "KK", basis: "art. 190a Â§1â€“2", penalty: "pozb. woln. 6 mies. â€“ 8 lat", minMonths: 6, maxMonths: 96, emoji: "ğŸ•µï¸" },
            { name: "Naruszenie miru domowego (wtargniÄ™cie / nieopuszczenie terenu)", law: "KK", basis: "art. 193", penalty: "grzywna / ograniczenie / pozb. woln. do 1 roku", minMonths: 1, maxMonths: 12, emoji: "ğŸ " },

            { name: "ZnÄ™canie siÄ™", law: "KK", basis: "art. 207 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat", minMonths: 3, maxMonths: 60, emoji: "ğŸ§±" },

            { name: "Pobicie / bÃ³jka (podstawowy typ)", law: "KK", basis: "art. 158 Â§1", penalty: "pozb. woln. do 3 lat", minMonths: 1, maxMonths: 36, emoji: "ğŸ¤œ" },

            { name: "Prowadzenie pojazdu w stanie nietrzeÅºwoÅ›ci (przestÄ™pstwo)", law: "KK", basis: "art. 178a Â§1", penalty: "pozb. woln. do 3 lat", minMonths: 1, maxMonths: 36, emoji: "ğŸº" },
            { name: "Nielegalne posiadanie broni palnej lub amunicji", law: "KK", basis: "art. 263 Â§2", penalty: "pozb. woln. 6 mies. â€“ 8 lat", minMonths: 6, maxMonths: 96, emoji: "ğŸ”«" },

            // WOLNOÅšÄ† / "porwania"
            { name: "Bezprawne pozbawienie wolnoÅ›ci", law: "KK", basis: "art. 189 Â§1", penalty: "pozb. woln. 3 mies. â€“ 5 lat (dÅ‚uÅ¼ej niÅ¼ 7 dni: 1 â€“ 10 lat)", minMonths: 3, maxMonths: 120, emoji: "ğŸšª" },
            { name: "Handel ludÅºmi", law: "KK", basis: "art. 189a Â§1", penalty: "pozb. woln. 3 â€“ 20 lat", minMonths: 36, maxMonths: 240, emoji: "â›“ï¸" },
            { name: "WziÄ™cie zakÅ‚adnika", law: "KK", basis: "art. 252 Â§1", penalty: "pozb. woln. 3 â€“ 20 lat", minMonths: 36, maxMonths: 240, emoji: "ğŸš¨" },

            // ABSURDALNE, ALE PRAWDZIWE
            { name: "ZÅ‚oÅ›liwe przeszkadzanie pogrzebowi / obrzÄ™dom", law: "KK", basis: "art. 195", penalty: "grzywna / ograniczenie / pozb. woln. do 2 lat", minMonths: 1, maxMonths: 24, emoji: "âš°ï¸" },
            { name: "ZniewaÅ¼enie pomnika lub miejsca pamiÄ™ci", law: "KK", basis: "art. 261", penalty: "grzywna / ograniczenie wolnoÅ›ci", minMonths: 0.5, maxMonths: 2, emoji: "ğŸ—¿" },
            { name: "Obraza uczuÄ‡ religijnych", law: "KK", basis: "art. 196", penalty: "grzywna / ograniczenie / pozb. woln. do 2 lat", minMonths: 1, maxMonths: 24, emoji: "â›ª" },
        ];

        function formatTime(months: number): string {
            if (months < 12) {
                return months === 1 ? "1 miesiÄ…c" : `${months} miesiÄ™cy`;
            } else {
                const years = Math.floor(months / 12);
                const remainingMonths = months % 12;
                if (remainingMonths === 0) {
                    return years === 1 ? "1 rok" : `${years} lat`;
                } else {
                    return `${years} ${years === 1 ? 'rok' : 'lat'} i ${remainingMonths} ${remainingMonths === 1 ? 'miesiÄ…c' : 'miesiÄ™cy'}`;
                }
            }
        }

        function calculateCrimes(targetMonths: number) {
            const result: Array<{crime: typeof offencesPL[0], count: number, totalMonths: number}> = [];
            let remainingMonths = targetMonths;
            
            // Sort crimes by average sentence (descending) to use greedy algorithm
            const sortedCrimes = [...offencesPL].sort((a, b) => {
                const avgA = (a.minMonths + a.maxMonths) / 2;
                const avgB = (b.minMonths + b.maxMonths) / 2;
                return avgB - avgA;
            });
            
            // Try to find a combination that gets close to the target
            for (const crime of sortedCrimes) {
                if (remainingMonths <= 0) break;
                
                // Use average sentence for calculation
                const avgSentence = (crime.minMonths + crime.maxMonths) / 2;
                const count = Math.floor(remainingMonths / avgSentence);
                
                if (count > 0) {
                    const totalForThisCrime = count * avgSentence;
                    result.push({ 
                        crime, 
                        count, 
                        totalMonths: totalForThisCrime 
                    });
                    remainingMonths -= totalForThisCrime;
                }
            }
            
            // If there's still remaining time, add smallest crimes
            if (remainingMonths > 0 && result.length > 0) {
                const smallestCrime = offencesPL.reduce((min, crime) => {
                    const avgMin = (min.minMonths + min.maxMonths) / 2;
                    const avgCrime = (crime.minMonths + crime.maxMonths) / 2;
                    return avgCrime < avgMin ? crime : min;
                });
                const avgSentence = (smallestCrime.minMonths + smallestCrime.maxMonths) / 2;
                const additionalCount = Math.ceil(remainingMonths / avgSentence);
                result.push({ 
                    crime: smallestCrime, 
                    count: additionalCount, 
                    totalMonths: additionalCount * avgSentence 
                });
            }
            
            return result;
        }

        // Elements
        const slider = document.getElementById('time-slider') as HTMLInputElement;
        const timeDisplay = document.getElementById('time-display') as HTMLElement;
        const calculateBtn = document.getElementById('calculate-btn') as HTMLButtonElement;
        const resultsDiv = document.getElementById('results') as HTMLElement;
        const resultTime = document.getElementById('result-time') as HTMLElement;
        const crimesList = document.getElementById('crimes-list') as HTMLElement;

        // Update display when slider moves
        slider.addEventListener('input', () => {
            const months = parseInt(slider.value);
            timeDisplay.textContent = formatTime(months);
        });

        // Calculate on button click
        calculateBtn.addEventListener('click', () => {
            const months = parseInt(slider.value);
            const crimeCombination = calculateCrimes(months);
            
            // Update result time
            resultTime.textContent = formatTime(months);
            
            // Clear previous results
            crimesList.innerHTML = '';
            
            // Add new results with animation
            crimeCombination.forEach((item, index) => {
                const crimeDiv = document.createElement('div');
                crimeDiv.className = 'bg-white/5 backdrop-blur rounded-xl p-6 border border-white/10 transform transition-all hover:scale-102 hover:bg-white/10 animate-slide-in';
                crimeDiv.style.animationDelay = `${index * 0.1}s`;
                crimeDiv.setAttribute('role', 'listitem');
                
                const avgSentence = (item.crime.minMonths + item.crime.maxMonths) / 2;
                const sentenceRange = `${formatTime(item.crime.minMonths)} â€“ ${formatTime(item.crime.maxMonths)}`;
                
                crimeDiv.innerHTML = `
                    <div class="flex items-center justify-between gap-4">
                        <div class="flex items-center gap-4 flex-1">
                            <span class="text-4xl flex-shrink-0" role="img" aria-label="${item.crime.name}">${item.crime.emoji}</span>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-white font-semibold text-lg leading-tight">${item.crime.name}</h3>
                                <p class="text-gray-400 text-sm mt-1">
                                    ${item.count}Ã— | Kara: ${sentenceRange}
                                </p>
                                <p class="text-gray-500 text-xs mt-0.5">
                                    ${item.crime.law} ${item.crime.basis}
                                </p>
                            </div>
                        </div>
                        <div class="text-right flex-shrink-0">
                            <div class="text-orange-400 font-bold text-xl">${formatTime(Math.round(item.totalMonths))}</div>
                            <div class="text-gray-400 text-sm">razem</div>
                        </div>
                    </div>
                `;
                
                crimesList.appendChild(crimeDiv);
            });
            
            // Show results with animation
            resultsDiv.classList.remove('hidden');
            resultsDiv.classList.add('animate-fade-in');
            
            // Scroll to results smoothly
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        });

        // Initialize display
        timeDisplay.textContent = formatTime(parseInt(slider.value));
    </script>

    <style>
        @keyframes fade-in {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slide-in {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .animate-fade-in {
            animation: fade-in 0.6s ease-out;
        }

        .animate-slide-in {
            animation: slide-in 0.4s ease-out backwards;
        }

        /* Custom slider styling */
        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #f97316, #dc2626);
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.5);
            transition: all 0.2s;
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 16px rgba(249, 115, 22, 0.7);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #f97316, #dc2626);
            cursor: pointer;
            border-radius: 50%;
            border: none;
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.5);
            transition: all 0.2s;
        }

        .slider::-moz-range-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 16px rgba(249, 115, 22, 0.7);
        }

        .hover\:scale-102:hover {
            transform: scale(1.02);
        }
    </style>
</body>
</html>
